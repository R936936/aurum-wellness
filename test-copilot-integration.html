<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Copilot Integration - Aurum Wellness</title>
    <style>
        body {
            background: #000;
            color: #00ff00;
            font-family: 'Courier New', monospace;
            padding: 20px;
        }
        .test-container {
            border: 2px solid #00ff00;
            padding: 20px;
            margin: 20px 0;
            background: rgba(0, 255, 0, 0.05);
        }
        button {
            background: #00ff00;
            color: #000;
            border: none;
            padding: 15px 30px;
            font-family: 'Courier New', monospace;
            font-weight: bold;
            cursor: pointer;
            margin: 10px 5px;
            font-size: 16px;
        }
        button:hover {
            background: #00dd00;
        }
        #output {
            white-space: pre-wrap;
            margin-top: 20px;
            padding: 20px;
            background: rgba(0, 0, 0, 0.7);
            border: 1px solid #00ff00;
            max-height: 600px;
            overflow-y: auto;
            font-size: 14px;
        }
        .success { color: #00ff00; font-weight: bold; }
        .error { color: #ff0000; font-weight: bold; }
        .warning { color: #ffff00; }
        .info { color: #00ddff; }
        h1 { text-shadow: 0 0 10px #00ff00; }
        .response-box {
            background: rgba(0, 100, 0, 0.3);
            padding: 15px;
            margin: 10px 0;
            border-left: 3px solid #00ff00;
        }
    </style>
</head>
<body>
    <h1>üß™ TEST DE INTEGRACI√ìN COPILOT + GPT-4 + MORPHEUS</h1>
    
    <div class="test-container">
        <h2>üìä Estado del Sistema</h2>
        <div id="status">Cargando...</div>
    </div>
    
    <div class="test-container">
        <h2>üöÄ Pruebas Automatizadas</h2>
        <button onclick="testFullSystem()">‚ñ∂Ô∏è EJECUTAR PRUEBA COMPLETA</button>
        <button onclick="testCopilotIntegration()">üíª TEST COPILOT</button>
        <button onclick="testScientificResponse()">üî¨ TEST CIENT√çFICO</button>
        <button onclick="clearOutput()">üóëÔ∏è Limpiar</button>
    </div>
    
    <div class="test-container">
        <h2>üìù Resultados</h2>
        <div id="output"></div>
    </div>

    <!-- Load Configuration -->
    <script src="config.js"></script>
    <script src="config.local.js"></script>
    
    <!-- Load Core -->
    <script src="wellness-core.js"></script>
    
    <!-- Load SuperWellnessAgent -->
    <script src="super-wellness-agent.js"></script>
    
    <script>
        function log(message, type = 'info') {
            const output = document.getElementById('output');
            const span = document.createElement('span');
            span.className = type;
            const timestamp = new Date().toLocaleTimeString();
            span.textContent = `[${timestamp}] ${message}\n`;
            output.appendChild(span);
            output.scrollTop = output.scrollHeight;
            console.log(message);
        }
        
        function clearOutput() {
            document.getElementById('output').innerHTML = '';
        }
        
        function updateStatus() {
            const status = document.getElementById('status');
            let html = '<div style="font-size: 14px;">';
            
            // Check components
            if (window.AURUM_CONFIG) {
                html += '<div class="success">‚úÖ AURUM_CONFIG: Cargado</div>';
                
                if (window.AURUM_CONFIG.openai?.enabled) {
                    if (window.AURUM_CONFIG.openai?.apiKey) {
                        html += '<div class="success">‚úÖ OpenAI GPT-4: HABILITADO</div>';
                    } else {
                        html += '<div class="error">‚ùå OpenAI: Sin API key</div>';
                    }
                } else {
                    html += '<div class="warning">‚ö™ OpenAI: Deshabilitado</div>';
                }
            } else {
                html += '<div class="error">‚ùå AURUM_CONFIG: No cargado</div>';
            }
            
            if (window.WellnessCore) {
                html += '<div class="success">‚úÖ WellnessCore: Inicializado</div>';
            } else {
                html += '<div class="error">‚ùå WellnessCore: No encontrado</div>';
            }
            
            if (window.SuperWellnessAgent) {
                html += '<div class="success">‚úÖ SuperWellnessAgent: Inicializado</div>';
                html += '<div class="success">üíª Copilot Context: INTEGRADO en system prompt</div>';
            } else {
                html += '<div class="error">‚ùå SuperWellnessAgent: No encontrado</div>';
            }
            
            html += '</div>';
            status.innerHTML = html;
        }
        
        async function testFullSystem() {
            clearOutput();
            log('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê', 'info');
            log('üöÄ INICIANDO PRUEBA COMPLETA DEL SISTEMA', 'success');
            log('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê', 'info');
            log('');
            
            // Test 1: Verificar componentes
            log('TEST 1: Verificando componentes...', 'info');
            if (window.AURUM_CONFIG) {
                log('  ‚úÖ AURUM_CONFIG: OK', 'success');
            } else {
                log('  ‚ùå AURUM_CONFIG: FALTA', 'error');
                return;
            }
            
            if (window.WellnessCore) {
                log('  ‚úÖ WellnessCore: OK', 'success');
            } else {
                log('  ‚ùå WellnessCore: FALTA', 'error');
                return;
            }
            
            if (window.SuperWellnessAgent) {
                log('  ‚úÖ SuperWellnessAgent: OK', 'success');
            } else {
                log('  ‚ùå SuperWellnessAgent: FALTA', 'error');
                return;
            }
            log('');
            
            // Test 2: Verificar configuraci√≥n
            log('TEST 2: Verificando configuraci√≥n Copilot...', 'info');
            const prompt = window.AURUM_CONFIG.morpheus?.systemPrompt || '';
            if (prompt.includes('Copilot')) {
                log('  ‚úÖ System prompt contiene "Copilot"', 'success');
            } else {
                log('  ‚ö†Ô∏è System prompt NO menciona Copilot', 'warning');
            }
            
            if (prompt.includes('Œ≤-oxidaci√≥n') || prompt.includes('BHB')) {
                log('  ‚úÖ Prompt incluye t√©rminos cient√≠ficos t√©cnicos', 'success');
            } else {
                log('  ‚ö†Ô∏è Prompt podr√≠a tener m√°s contenido t√©cnico', 'warning');
            }
            
            if (prompt.length > 500) {
                log(`  ‚úÖ Prompt es extenso (${prompt.length} caracteres)`, 'success');
            } else {
                log(`  ‚ö†Ô∏è Prompt es corto (${prompt.length} caracteres)`, 'warning');
            }
            log('');
            
            // Test 3: Query de prueba
            log('TEST 3: Probando query con GPT-4...', 'info');
            log('  üì§ Enviando: "¬øqu√© es la cetosis?"', 'info');
            log('  ‚è≥ Esperando respuesta...', 'warning');
            
            try {
                const startTime = Date.now();
                const response = await window.SuperWellnessAgent.process('¬øqu√© es la cetosis?');
                const endTime = Date.now();
                const duration = ((endTime - startTime) / 1000).toFixed(2);
                
                log('', 'info');
                log('  ‚úÖ RESPUESTA RECIBIDA:', 'success');
                log('  ‚è±Ô∏è  Tiempo: ' + duration + ' segundos', 'info');
                log('  üìè Longitud: ' + response.length + ' caracteres', 'info');
                log('', 'info');
                log('  üìù Contenido:', 'info');
                log('  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ', 'info');
                
                const output = document.getElementById('output');
                const responseBox = document.createElement('div');
                responseBox.className = 'response-box';
                responseBox.textContent = response;
                output.appendChild(responseBox);
                
                log('  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ', 'info');
                log('', 'info');
                
                // An√°lisis de calidad
                log('TEST 4: An√°lisis de calidad de respuesta...', 'info');
                
                const hasNumbers = /\d+/.test(response);
                const hasScientificTerms = /cetona|BHB|acetoacetato|lip√≥lisis|glucag√≥n/i.test(response);
                const hasTimeline = /d√≠a|semana|hora/i.test(response);
                const isLong = response.length > 500;
                const hasTechnical = /‚Üí|‚Üì|‚Üë|mmol/.test(response);
                
                if (hasNumbers) log('  ‚úÖ Contiene n√∫meros y datos concretos', 'success');
                else log('  ‚ö†Ô∏è No contiene suficientes n√∫meros', 'warning');
                
                if (hasScientificTerms) log('  ‚úÖ Usa t√©rminos cient√≠ficos', 'success');
                else log('  ‚ö†Ô∏è Faltan t√©rminos cient√≠ficos', 'warning');
                
                if (hasTimeline) log('  ‚úÖ Incluye timelines', 'success');
                else log('  ‚ö†Ô∏è No incluye timelines', 'warning');
                
                if (isLong) log('  ‚úÖ Respuesta detallada (>500 chars)', 'success');
                else log('  ‚ö†Ô∏è Respuesta corta (<500 chars)', 'warning');
                
                if (hasTechnical) log('  ‚úÖ Usa s√≠mbolos t√©cnicos (‚Üí, ‚Üì, ‚Üë)', 'success');
                else log('  ‚ö†Ô∏è No usa s√≠mbolos t√©cnicos Copilot-style', 'warning');
                
                log('', 'info');
                
                // Conclusi√≥n
                const score = [hasNumbers, hasScientificTerms, hasTimeline, isLong, hasTechnical].filter(Boolean).length;
                const percentage = (score / 5 * 100).toFixed(0);
                
                log('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê', 'info');
                log(`üéØ PUNTUACI√ìN FINAL: ${score}/5 (${percentage}%)`, score >= 4 ? 'success' : 'warning');
                
                if (score >= 4) {
                    log('‚úÖ COPILOT INTEGRACI√ìN: EXITOSA', 'success');
                    log('   El sistema est√° respondiendo con estilo Copilot', 'success');
                } else if (score >= 3) {
                    log('‚ö†Ô∏è COPILOT INTEGRACI√ìN: PARCIAL', 'warning');
                    log('   El sistema funciona pero podr√≠a mejorar', 'warning');
                } else {
                    log('‚ùå COPILOT INTEGRACI√ìN: NECESITA MEJORA', 'error');
                    log('   Verificar que config.local.js se carg√≥ correctamente', 'error');
                }
                log('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê', 'info');
                
            } catch (error) {
                log('  ‚ùå ERROR: ' + error.message, 'error');
                log('  Stack: ' + error.stack, 'error');
            }
        }
        
        async function testCopilotIntegration() {
            clearOutput();
            log('üß™ TEST ESPEC√çFICO DE INTEGRACI√ìN COPILOT', 'success');
            log('', 'info');
            
            const prompt = window.AURUM_CONFIG.morpheus?.systemPrompt || '';
            
            log('Verificando system prompt...', 'info');
            log(`Longitud: ${prompt.length} caracteres`, 'info');
            log('', 'info');
            
            const checks = [
                { name: 'Menciona "Copilot"', test: () => prompt.includes('Copilot') },
                { name: 'Menciona "GPT-4"', test: () => prompt.includes('GPT-4') },
                { name: 'Incluye t√©rminos t√©cnicos', test: () => /Œ≤-oxidaci√≥n|BHB|acetoacetato|mTOR|AMPK/i.test(prompt) },
                { name: 'Incluye s√≠mbolos t√©cnicos', test: () => /‚Üí|‚Üì|‚Üë/.test(prompt) },
                { name: 'Menciona an√°lisis cient√≠fico', test: () => /cient√≠fico|bioqu√≠mica|mecanismo/i.test(prompt) },
                { name: 'Tiene estructura definida', test: () => prompt.includes('ESTRUCTURA') || prompt.includes('FORMATO') },
                { name: 'Es extenso (>1000 chars)', test: () => prompt.length > 1000 }
            ];
            
            let passed = 0;
            checks.forEach(check => {
                const result = check.test();
                if (result) {
                    log(`  ‚úÖ ${check.name}`, 'success');
                    passed++;
                } else {
                    log(`  ‚ùå ${check.name}`, 'error');
                }
            });
            
            log('', 'info');
            log(`Resultado: ${passed}/${checks.length} checks pasados`, passed === checks.length ? 'success' : 'warning');
        }
        
        async function testScientificResponse() {
            clearOutput();
            log('üî¨ TEST DE RESPUESTA CIENT√çFICA', 'success');
            log('', 'info');
            log('Probando con pregunta t√©cnica...', 'info');
            log('Pregunta: "Explica el proceso de autofagia a nivel molecular"', 'info');
            log('', 'info');
            log('‚è≥ Esperando respuesta de GPT-4 + Copilot...', 'warning');
            
            try {
                const response = await window.SuperWellnessAgent.process('Explica el proceso de autofagia a nivel molecular');
                
                log('‚úÖ Respuesta recibida', 'success');
                log('', 'info');
                
                const output = document.getElementById('output');
                const responseBox = document.createElement('div');
                responseBox.className = 'response-box';
                responseBox.textContent = response;
                output.appendChild(responseBox);
                
                log('', 'info');
                log('An√°lisis:', 'info');
                
                if (response.includes('mTOR') || response.includes('AMPK')) {
                    log('  ‚úÖ Menciona prote√≠nas clave (mTOR/AMPK)', 'success');
                } else {
                    log('  ‚ö†Ô∏è No menciona prote√≠nas clave', 'warning');
                }
                
                if (/\d/.test(response)) {
                    log('  ‚úÖ Incluye datos num√©ricos', 'success');
                } else {
                    log('  ‚ö†Ô∏è Falta datos num√©ricos', 'warning');
                }
                
                if (response.length > 500) {
                    log('  ‚úÖ Respuesta detallada', 'success');
                } else {
                    log('  ‚ö†Ô∏è Respuesta podr√≠a ser m√°s detallada', 'warning');
                }
                
            } catch (error) {
                log('‚ùå Error: ' + error.message, 'error');
            }
        }
        
        // Update status on load
        window.addEventListener('load', () => {
            setTimeout(updateStatus, 1000);
            log('‚úÖ Sistema cargado. Listo para pruebas.', 'success');
            log('üí° Presiona "EJECUTAR PRUEBA COMPLETA" para verificar integraci√≥n', 'info');
        });
    </script>
</body>
</html>
